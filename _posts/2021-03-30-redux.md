---
layout: post
title: "redux 맛보기"
featured-img: redux
categories: [Redux]
---

## redux란?

상태를 관리할 필요가 있는 react에서는 사실상 필수적으로 사용이 요구되는 라이브러리, 자바스크립트 어플리케이션을 위한 라이브러리이다.
angular, vue, vanila에서도 사용 가능!  
react-redux 라이브러리를 통해서 react에서 사용됨

## redux 왜 사용하는지?

각 컴포넌트는 각각의 state를 가지고 있고 리액트 컴포넌트 트리에서 sibling 컴포넌트들 끼리의 state 공유 시 부모
컴포넌트에서 state가 관리돼야 한다.
but 부모의 sibling 컴포넌트에서도 state를 사용해야 할 시 부모의 부모 컴포넌트에서 state를 관리 ... 이런 식으로 계속 거슬러 올라가서 state를 관리해줘야 한다(앱의 규모가 큰 경우).
state를 어딘가에 저장해놓고 바로 state를 가져올 수 있는 방법이 필요 -> redux를 통해 state를 직접적으로 각각의 컴포넌트에서 사용이 가능하다.

## redux에서 중요한 core concept

component(화면을 보여줄 view -> app) store(어떠한 정보를 저장하는 공간) store에서 정보를 가져와서 component에서 사용
component에서 값이 변동이 일어나면 그 값을 store에 update. but direct하게 업데이트를 시키는게 아니라 action, reducer을 통해서 값을 관리
component dispatch을 통해 action으로 호출, action에서 정의되어 있는 내용이 reducer에 의해서 핸들링, 핸들링에 따라 상태 값이 update! update된 store을 실시간으로 subscribe를 통해서 받아와서 사용

```javascript
// store_1.js
const redux = requre("redux");
//npm install redux-logger
const reduxLogger = require("redux-logger");
// 함수 자체를 변수에 넣어줌
const createStore = redux.createStore;
const applyMiddleware = redux.applyMiddleware;
// 함수를 변수에 넣어줌
const logger = reduxLogger.createLogger;
// actions
// action-types(반복해서 사용할 것이므로 type을 정의)
const ADD_SUBSCRIBER = "ADD_SUBSCRIBER";
const addSubscriber = () => {
  // object return
  return {
    //일반적인 convention
    type: ADD_SUBSCRIBER,
  };
};
// reducers
const initialState = {
  subscribers: 365,
};
const reducer = (state = initialState, action) => {
  switch (action.type) {
    case ADD_SUBSCRIBER:
      return {
        ...state,
        subscribers: state.subscribers + 1,
      };
    default:
      return state;
  }
};

// store   인자로 reducer을 바로 넘겨줌
const store = createStore(reducer);
// subscribe - view - dispatch
console.log(store.getState()); // { subscribers: 365} 출력됨
store.dispatch(addSubscriber()); //action 호출 -> reducer가 작동을 하면서 상태의 값이 변동
console.log(store.getState()); // { subscribers: 366} 출력됨

store.subscribe(() => {
  " >console.log("subscribe ==>>", store.getState());

});
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
// subscribe ==>> { subscribers: 366}
// subscribe ==>> { subscribers: 367}
// subscribe ==>> { subscribers: 368}
// subscribe ==>> { subscribers: 369}
// subscribe ==>> { subscribers: 370}  5번 출력됨
```

```javascript
const redux = require("redux");
//npm install redux-logger
const reduxLogger = require("redux-logger");
// 함수 자체를 변수에 넣어줌
const createStore = redux.createStore;
const applyMiddleware = redux.applyMiddleware;
// 함수를 변수에 넣어줌
const logger = reduxLogger.createLogger;
const combineReducers = redux.combineReducers;
// actions
// action-types(반복해서 사용할 것이므로 type을 정의)
const ADD_SUBSCRIBER = "ADD_SUBSCRIBER";
const ADD_VIEWCOUNT = "ADD_VIEWCOUNT";
const addSubscriber = () => {
  // object return
  return {
    //일반적인 convention
    type: ADD_SUBSCRIBER,
  };
};
const addViewCount = () => {
  // object return
  return {
    //일반적인 convention
    type: ADD_VIEWCOUNT,
  };
};
// reducers
const subscriberState = {
  subscribers: 365,
};
const subscriberReducer = (state = subscriberState, action) => {
  switch (action.type) {
    case ADD_SUBSCRIBER:
      return {
        ...state,
        subscribers: state.subscribers + 1,
      };
    default:
      return state;
  }
};
const viewState = {
  viewCount: 100,
};
const viewReducer = (state = viewState, action) => {
  switch (action.type) {
    case ADD_VIEWCOUNT:
      return {
        ...state,
        viewCount: state.viewCount + 1,
      };
    default:
      return state;
  }
};

const rootReducer = combineReducers({
  view: viewReducer,
  subscriber: subscriberReducer,
});
// store  인자로 reducer을 바로 넘겨줌
// 두 개의 reducer가 combining돼서 store로 사용할 수 있게 됨
// store 생성 시 middleware추가해서 log를 찍어볼 수 있음..
const store = createStore(rootReducer, applyMiddleware(logger));
// subscribe - view - dispatch
console.log(store.getState()); // { subscribers: 365} 출력됨
store.dispatch(addSubscriber()); //action 호출 -> reducer가 작동을 하면서 상태의 값이 변동
console.log(store.getState()); // { subscribers: 366} 출력됨

// store.subscribe(() => {
//   " >console.log("subscribe ==>>", store.getState());

// });
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
store.dispatch(addSubscriber());
store.dispatch(addViewCount());
store.dispatch(addViewCount());
```
